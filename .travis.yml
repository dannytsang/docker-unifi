sudo: required

services:
  - docker

env:
  - DOCKER_VERSION: 1.13.1-0~ubuntu-trusty
  - COMPOSE_VERSION: 1.11.2

before_install:
  # list docker-engine versions
  - apt-cache madison docker-engine
  # upgrade docker-engine to specific version
  - sudo apt-get -o Dpkg::Options::="--force-confnew" install -y docker-engine=1.13.1-0~ubuntu-trusty
  # install docker compose
  - sudo curl -L "https://github.com/docker/compose/releases/download/"$COMPOSE_VERSION"/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
  - sudo chmod +x /usr/local/bin/docker-compose

script:
  - sudo docker-compose up -d
  - wait 5
  - if [ ! -f ~/contents/unifi/data/keystore ]; then exit 1; fi
